<!DOCTYPE html>
<html>
<head>
	<title>Прилипание к геометрии</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="./css/leaflet.css" />
	<link rel="stylesheet" href="./css/leaflet.draw.css" />
	<style>
		html,body,#map{
			padding:0;
			margin: 0;
			height: 100%;
			width: 100%;
		}
	</style>
</head>
<body>
	<div id="map"></div>
	<script src="./js/leaflet.js"></script>
	<script src="./js/leaflet.draw.js"></script>
	<script src="./js/leaflet.ajax.min.js"></script>
	<script src="js/leaflet.geometryutil.js"></script>
	<script src="./js/leaflet.snap.js"></script>
	<script>
		var map = L.map('map').setView([51.959508,34.190926], 12);
		L.tileLayer('http://tiles.maps.sputnik.ru/tiles/kmt{s}/{z}/{x}/{y}.png').addTo(map);
		
		var geojson = new L.GeoJSON.AJAX("./js/regions_rf.geojson");
		geojson.addTo(map);

		var drawnItems = new L.FeatureGroup();
		map.addLayer(drawnItems);

		var points = [geojson];
		var drawControl = new L.Control.Draw({
		    draw: {
				marker: {guideLayers: points, snapDistance: 25},
				polyline: false,
		        polygon: false,
				rectangle: false,
				circle: false
		    }
		});
		map.addControl(drawControl);

		map.on('draw:created', function (event) {
			var l = event.layer;
			l.snapediting = new L.Handler.PolylineSnap(map,l);
		    l.snapediting.addGuideLayer(points);
		    l.snapediting.enable();
		    drawnItems.addLayer(l);
			points.push(l);
		});

	</script>
</body>
</html>
